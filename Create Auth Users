# create the authdb directories:

mkdir -p /data/db/authdb /data/db/authdb/logs

# start without auth enabled:

mongod --port 21050 --dbpath /data/db/authdb --logpath /data/db/authdb/logs/log1.log --fork

# connect to it

mongo --port 21050

# create the admin user:

use admin
db.createUser(
  {
    user: "myUserAdmin",
    pwd: "abc123",
    roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
  }
)

exit

########## kill the mongod running on 21050 ############

# restart the mongod with auth enabled:

mongod --auth --port 21050 --dbpath /data/db/authdb --logpath /data/db/authdb/logs/log1.log --fork

# connect as the admin user:

mongo --port 21050 -u "myUserAdmin" -p "abc123" --authenticationDatabase "admin"

# create a new user

use admin
db.createUser(
  {
    user: "adminChris",
    pwd: "adminChris",
    roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
  }
)


